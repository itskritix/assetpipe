---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Dashboard">
  <div class="mx-auto max-w-4xl px-4 py-12">
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
      <p id="user-email" class="mt-2 text-gray-600"></p>
    </div>

    <div class="grid gap-6 md:grid-cols-2">
      <a href="/dashboard/submissions" class="block rounded-xl border bg-white p-6 shadow-sm transition hover:shadow-md">
        <div class="mb-4 flex h-12 w-12 items-center justify-center rounded-lg bg-brand-100">
          <svg class="h-6 w-6 text-brand-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
          </svg>
        </div>
        <h2 class="text-lg font-semibold text-gray-900">My Submissions</h2>
        <p class="mt-1 text-sm text-gray-600">View and manage your logo submissions</p>
      </a>

      <a href="/dashboard/api-keys" class="block rounded-xl border bg-white p-6 shadow-sm transition hover:shadow-md">
        <div class="mb-4 flex h-12 w-12 items-center justify-center rounded-lg bg-brand-100">
          <svg class="h-6 w-6 text-brand-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
          </svg>
        </div>
        <h2 class="text-lg font-semibold text-gray-900">API Keys</h2>
        <p class="mt-1 text-sm text-gray-600">Manage your API access keys</p>
      </a>

      <a href="/submit" class="block rounded-xl border bg-white p-6 shadow-sm transition hover:shadow-md">
        <div class="mb-4 flex h-12 w-12 items-center justify-center rounded-lg bg-green-100">
          <svg class="h-6 w-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
        </div>
        <h2 class="text-lg font-semibold text-gray-900">Submit a Logo</h2>
        <p class="mt-1 text-sm text-gray-600">Contribute a new logo to the library</p>
      </a>

      <a href="/browse" class="block rounded-xl border bg-white p-6 shadow-sm transition hover:shadow-md">
        <div class="mb-4 flex h-12 w-12 items-center justify-center rounded-lg bg-purple-100">
          <svg class="h-6 w-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>
        <h2 class="text-lg font-semibold text-gray-900">Browse Logos</h2>
        <p class="mt-1 text-sm text-gray-600">Explore the logo library</p>
      </a>
    </div>

    <div class="mt-8">
      <button
        id="logout-btn"
        class="rounded-lg border border-gray-300 px-4 py-2 text-sm text-gray-700 transition hover:bg-gray-50"
      >
        Sign Out
      </button>
    </div>
  </div>
</Layout>

<script>
  import { createClient } from '@supabase/supabase-js';

  const supabaseUrl = import.meta.env.PUBLIC_SUPABASE_URL;
  const supabaseAnonKey = import.meta.env.PUBLIC_SUPABASE_ANON_KEY;
  const supabase = createClient(supabaseUrl, supabaseAnonKey);

  // Check if user is logged in
  const { data: { user } } = await supabase.auth.getUser();

  if (!user) {
    window.location.href = '/login';
  } else {
    const userEmail = document.getElementById('user-email');
    if (userEmail) {
      userEmail.textContent = `Signed in as ${user.email}`;
    }
  }

  // Logout handler
  document.getElementById('logout-btn')?.addEventListener('click', async () => {
    await supabase.auth.signOut();
    window.location.href = '/';
  });
</script>
